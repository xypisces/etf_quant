# ETF é‡åŒ–äº¤æ˜“ç³»ç»Ÿ (etf-quant)

åŸºäº Python çš„ ETF é‡åŒ–äº¤æ˜“å›æµ‹æ¡†æ¶ï¼Œé‡‡ç”¨äº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œæ”¯æŒç­–ç•¥å¼€å‘ã€é£æ§ç®¡ç†å’Œç»©æ•ˆåˆ†æã€‚

## ç‰¹æ€§

- ğŸ”„ **äº‹ä»¶é©±åŠ¨å›æµ‹** â€” é€ bar æ¨é€ï¼Œä¸å®ç›˜é€»è¾‘ä¸€è‡´
- ğŸ“Š **æ ‡å‡†åŒ–ç­–ç•¥æ¥å£** â€” ç»§æ‰¿ `Strategy` åŸºç±»å³å¯å¼€å‘æ–°ç­–ç•¥
- ğŸ›¡ï¸ **å†…ç½®é£æ§** â€” æ­¢æŸæ­¢ç›ˆã€æœ€å¤§æŒä»“é™åˆ¶
- ğŸ’° **ä»“ä½ç®¡ç†** â€” æ”¯æŒå›ºå®šæ¯”ä¾‹ / ATR / Kelly å…¬å¼
- ğŸ“ˆ **ç»©æ•ˆåˆ†æ** â€” å¤æ™®æ¯”ç‡ã€æœ€å¤§å›æ’¤ã€èƒœç‡ã€ç›ˆäºæ¯”
- ğŸ¨ **ç»“æœå¯è§†åŒ–** â€” ç­–ç•¥ vs åŸºå‡†æ”¶ç›Šå¯¹æ¯”å›¾

## é¡¹ç›®ç»“æ„

```
etf_quant/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â””â”€â”€ loader.py           # ç»Ÿä¸€æ•°æ®åŠ è½½æ¥å£ (CSV/akshare API)
â”‚   â”œâ”€â”€ strategy/
â”‚   â”‚   â”œâ”€â”€ base.py             # Strategy åŸºç±» + Signal æšä¸¾
â”‚   â”‚   â””â”€â”€ ma_cross.py         # åŒå‡çº¿äº¤å‰ç­–ç•¥
â”‚   â”œâ”€â”€ backtest/
â”‚   â”‚   â”œâ”€â”€ engine.py           # äº‹ä»¶é©±åŠ¨å›æµ‹å¼•æ“
â”‚   â”‚   â””â”€â”€ metrics.py          # ç»©æ•ˆæŒ‡æ ‡è®¡ç®—
â”‚   â”œâ”€â”€ risk/
â”‚   â”‚   â”œâ”€â”€ position_sizer.py   # ä»“ä½ç®¡ç† (å›ºå®šæ¯”ä¾‹/ATR/Kelly)
â”‚   â”‚   â””â”€â”€ risk_manager.py     # æ­¢æŸæ­¢ç›ˆã€æŒä»“é™åˆ¶
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ plotting.py         # æ”¶ç›Šæ›²çº¿å¯è§†åŒ–
â”‚   â””â”€â”€ main.py                 # å…¥å£è„šæœ¬
â”œâ”€â”€ csv/                        # æ•°æ®ç¼“å­˜
â””â”€â”€ results/                    # å›æµ‹ç»“æœè¾“å‡º
```

## å¿«é€Ÿä¸Šæ‰‹

### ç¯å¢ƒè¦æ±‚

- Python >= 3.12
- [uv](https://github.com/astral-sh/uv) åŒ…ç®¡ç†å™¨

### å®‰è£…ä¾èµ–

```bash
uv sync
```

### è¿è¡Œå›æµ‹

```bash
uv run python -m src.main
```

é»˜è®¤é…ç½®ï¼š
- æ ‡çš„ï¼šæ²ªæ·±300 ETF (510300)
- ç­–ç•¥ï¼šåŒå‡çº¿äº¤å‰ (MA5/MA20)
- åˆå§‹èµ„é‡‘ï¼šÂ¥100,000
- æ­¢æŸ/æ­¢ç›ˆï¼š-5% / +10%

### è‡ªå®šä¹‰ç­–ç•¥

ç»§æ‰¿ `Strategy` åŸºç±»ï¼Œå®ç° `on_bar()` å’Œ `generate_signal()` æ–¹æ³•ï¼š

```python
from src.strategy.base import Strategy, Signal

class MyStrategy(Strategy):
    def on_bar(self, bar: dict) -> None:
        # æ¥æ”¶ K çº¿æ•°æ®ï¼Œæ›´æ–°å†…éƒ¨çŠ¶æ€
        pass

    def generate_signal(self) -> Signal:
        # è¿”å› BUY / SELL / HOLD
        return Signal.HOLD
```

## ä¾èµ–

| åŒ… | ç”¨é€” |
|---|------|
| pandas | æ•°æ®å¤„ç† |
| akshare | æ•°æ®è·å– |
| matplotlib | å¯è§†åŒ– |